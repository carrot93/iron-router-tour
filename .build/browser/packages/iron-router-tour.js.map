{"version":3,"file":"/packages/iron-router-tour.js","sources":["iron-router-tour/iron-router-tour.js","iron-router-tour/iron-router-tour.html"],"names":[],"mappings":";;;;;;;;AAAA,2B;;AAEA,2B;;AAEA,mC;AACA,mD;AACA,0B;AACA,G;;AAEA,I;;AAEA,G;;AAEA,8D;;AAEA,e;;AAEA,iE;AACA,6B;;AAEA,+B;;AAEA,iC;;AAEA,mB;;AAEA,iD;AACA,sC;;AAEA,G;AACA,Q;;AAEA,sC;AACA,oD;;AAEA,G;AACA,gC;;AAEA,E;;AAEA,a;;AAEA,E;;AAEA,kB;;AAEA,sB;;AAEA,gB;AACA,4C;AACA,uB;AACA,2B;AACA,oB;AACA,4B;AACA,sB;AACA,iB;AACA,c;AACA,a;AACA,G;;AAEA,oC;AACA,kC;AACA,G;;AAEA,2B;AACA,sB;AACA,c;AACA,8C;AACA,e;AACA,G;;AAEA,sB;AACA,qB;AACA,G;;AAEA,uB;AACA,2B;AACA,qB;AACA,iB;AACA,gB;AACA,gC;AACA,oB;AACA,K;AACA,I;AACA,G;;AAEA,yB;AACA,G;AACA,8C;AACA,yC;AACA,e;;AAEA,6D;;AAEA,4B;;AAEA,uC;AACA,4B;AACA,0G;AACA,0E;AACA,I;AACA,4E;AACA,I;AACA,kC;;AAEA,Y;AACA,kC;;AAEA,sB;AACA,qC;AACA,sC;AACA,O;AACA,mF;AACA,I;AACA,Y;AACA,6B;AACA,gC;AACA,I;AACA,kC;AACA,I;AACA,8B;AACA,+E;AACA,Y;AACA,gC;AACA,I;AACA,4C;AACA,G;AACA,K;AACA,G;AACA,+C;AACA,G;AACA,mC;AACA,8B;AACA,G;AACA,I;AACA,yC;AACA,G;AACA,0D;AACA,6B;AACA,G;AACA,I;AACA,O;AACA,sC;AACA,G;;AAEA,kD;;AAEA,wC;AACA,uC;AACA,iC;AACA,mC;AACA,iC;;AAEA,yB;;AAEA,e;AACA,oE;AACA,kD;AACA,U;;AAEA,kB;AACA,oE;AACA,mD;AACA,U;;AAEA,gB;AACA,oE;AACA,mD;AACA,U;;AAEA,iB;AACA,oE;AACA,mD;AACA,U;;AAEA,Y;AACA,uD;AACA,wD;;AAEA,U;AACA,I;;AAEA,gI;AACA,uD;;AAEA,kB;;AAEA,G;;AAEA,U;AACA,G;AACA,wB;AACA,sB;AACA,oB;AACA,sB;AACA,E;AACA,G;;AAEA,M;;AAEA,G;;;;;;;;;;;;;;;;;;;ACvMA,6C;AACA,kB;AACA,sB;AACA,mB;AACA,wC;AACA,0D;AACA,wB;AACA,0D;AACA,iB;AACA,4C;AACA,uB;AACA,4C;AACA,8D;AACA,O;AACA,gC;AACA,gD;AACA,0B;AACA,oB;AACA,oB;AACA,2C;AACA,6D;AACA,S;AACA,mB;AACA,sD;AACA,O;AACA,kC;AACA,kD;AACA,0B;AACA,oB;AACA,mB;AACA,6C;AACA,+D;AACA,S;AACA,mB;AACA,wD;AACA,O;AACA,0B;AACA,0C;AACA,4D;AACA,O;AACA,iB;AACA,yD;AACA,sB;AACA,I","sourcesContent":["Meteor.startup(function() {\n\n\tTemplate.tourStep.events({\n\n\t\t'click .tourButton': function() {\n\t\t\tthis.after && this.after.apply(this, arguments);\n\t\t\tRouter.Tour.nextStep();\n\t\t}\n\n\t});\n\n});\n\nvar renderOnce = function(template, oneTimeFunc, afterwards) {\n\n\tvar oldRender;\n\n\tif (typeof template === \"string\") template = Template[template];\n\tif (!template) return false;\n\n\toldRender = template.rendered;\n\n\ttemplate.rendered = function() {\n\n\t\tif (afterwards) {\n\n\t\t\toldRender && oldRender.apply(this, arguments);\n\t\t\toneTimeFunc.apply(this, arguments);\n\n\t\t}\n\t\telse {\n\n\t\t\toneTimeFunc.apply(this, arguments);\n\t\t\toldRender && oldRender.apply(this, arguments);\t\t\t\n\n\t\t}\n\t\ttemplate.rendered = oldRender;\n\n\t}\n\n\treturn true;\n\n};\n\n_.extend(Router, {\n\n\tTour : (function($) {\n\n\t\tvar config = {\n\t\t\tmainClass: 'ui segment whitetranslucent',\n\t\t\tinternalClass: 'ui',\n\t\t\ttitleClass: 'ui header',\n\t\t\tcontentClass: '',\n\t\t\tbuttonClass: 'ui button',\n\t\t\tbuttonText: 'Next',\n\t\t\tarrowSize: 20,\n\t\t\tgapSize: 5,\n\t\t\twidth: 300\n\t\t}\n\n\t\tfunction setConfig(configObject) {\n\t\t\t_.extend(config, configObject);\n\t\t}\n\n\t\tfunction loadTour(tour) {\n\t\t\ttourDetails = tour;\n\t\t\t_index = 0;\n\t\t\t_tourLength = tour ? tour.steps.length : 0;\n\t\t\treturn true;\n\t\t}\n\n\t\tfunction getTour() {\n\t\t\treturn tourDetails\n\t\t}\n\n\t\tfunction nextStep() {\n\t\t\t$('.tourMain').remove();\n\t\t\tif (tourDetails) {\n\t\t\t\trenderStep();\n\t\t\t\t_index += 1;\n\t\t\t\tif (_index >= _tourLength) {\n\t\t\t\t\tloadTour(null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction renderStep() {\n\t\t\t\n\t\t\tvar thisPage = Router.current().route.name,\n\t\t\t\tthisStep = tourDetails.steps[_index],\n\t\t\t\trenderFunc;\n\n\t\t\tthisStep.before && thisStep.before.apply(this, arguments);\n\n\t\t\trenderFunc = function() {\n\n\t\t\t\tvar target = $(thisStep.target)[0],\n\t\t\t\t\tparent = document.body,\n\t\t\t\t\tdirection = screen.width > 640 ? thisStep.placement : thisStep.mobilePlacement || thisStep.placement,\n\t\t\t\t\tcontext = _.extend( {}, config, { direction: direction }, thisStep );\n\t\t\t\t\n\t\t\t\tUI.insert(UI.renderWithData(Template.tourStep, context), document.body);\n\t\t\t\t\n\t\t\t\tvar tourMain = $('.tourMain');\n\n\t\t\t\ttourMain\n\t\t\t\t\t.css('width', context.width);\n\n\t\t\t\tvar dimensions = {\n\t\t\t\t\t\twidth: tourMain[0].scrollWidth,\n\t\t\t\t\t\theight: tourMain[0].scrollHeight\n\t\t\t\t\t},\n\t\t\t\t\toffsets = getOffsets(target ? target : document.body, tourMain[0], direction);\n\t\t\t\t\n\t\t\t\ttourMain\n\t\t\t\t\t.css('top', offsets.top)\n\t\t\t\t\t.css('left', offsets.left);\n\t\t\t\t\n\t\t\t\tMeteor.setTimeout(function() {\n\t\t\t\t\n\t\t\t\t\t$('html, body').animate({\n\t\t\t\t\t\tscrollTop: ($('.tourMain').first().offset().top - (window.innerHeight/2))\n\t\t\t\t\t},500);\n\t\t\t\t\ttourMain.css('opacity', 1);\n\t\t\t\t\n\t\t\t\t}, thisStep.delay ? thisStep.delay : 0);\n\t\t\t\n\t\t\t};\n\t\t\t\n\t\t\tif (!(thisStep.content || thisStep.title)) {\n\t\t\t\n\t\t\t\tif (thisPage !== thisStep.page)\n\t\t\t\t\tRouter.go(thisStep.page);\n\t\t\t\n\t\t\t}\n\t\t\telse if (thisPage !== thisStep.page) {\n\t\t\t\n\t\t\t\trenderOnce(thisStep.targetTemplate, renderFunc, true);\n\t\t\t\tRouter.go(thisStep.page);\n\t\t\t\n\t\t\t}\n\t\t\telse\n\t\t\t\trenderFunc.apply(this, arguments);\n\t\t}\n\n\t\tfunction getOffsets(target, node, boxPosition) {\n\n\t\t\tvar targetWidth = target.scrollWidth,\n\t\t\t\ttargetHeight = target.scrollHeight,\n\t\t\t\tnodeWidth = node.scrollWidth,\n\t\t\t\tnodeHeight = node.scrollHeight,\n\t\t\t\toffsets = $(target).offset();\n\n\t\t\tswitch (boxPosition) {\n\n\t\t\t\tcase 'top':\n\t\t\t\toffsets.top += - nodeHeight - config.arrowSize - config.gapSize;\n\t\t\t\toffsets.left += (targetWidth - nodeWidth) / 2;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'bottom':\n\t\t\t\toffsets.top += targetHeight + config.arrowSize + config.gapSize;\n\t\t\t\toffsets.left +=  (targetWidth - nodeWidth) / 2;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'left':\n\t\t\t\toffsets.left += - nodeWidth - config.arrowSize - config.gapSize;\n\t\t\t\toffsets.top += (targetHeight - nodeHeight) / 2;\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'right':\n\t\t\t\toffsets.left += targetWidth + config.arrowSize + config.gapSize;\n\t\t\t\toffsets.top += (targetHeight - nodeHeight) / 2;\n\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\toffsets.left = (window.innerWidth - nodeWidth) / 2;\n\t\t\t\toffsets.top = (window.innerHeight - nodeHeight) / 2;\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\toffsets.left = Math.min( Math.max(config.gapSize, offsets.left), document.body.scrollWidth - config.width - config.gapSize );\n\t\t\toffsets.top = Math.max(config.gapSize, offsets.top);\n\n\t\t\treturn offsets;\n\n\t\t}\n\n\t\treturn {\n\t\t\t\n\t\t\tsetConfig: setConfig,\n\t\t\tloadTour: loadTour,\n\t\t\tgetTour: getTour,\n\t\t\tnextStep: nextStep,\n\t\t\n\t\t}\n\n\t}($))\n\n});","\nTemplate.__define__(\"tourStep\", (function() {\n  var self = this;\n  var template = this;\n  return HTML.DIV({\n    \"class\": [ \"tourMain \", function() {\n      return Spacebars.mustache(self.lookup(\"mainClass\"));\n    }, \" \", function() {\n      return Spacebars.mustache(self.lookup(\"direction\"));\n    }, \"Arrow\" ],\n    style: \"position: absolute; opacity: 0;\"\n  }, \"\\n\t\t\", HTML.DIV({\n    \"class\": [ \"tourInternal \", function() {\n      return Spacebars.mustache(self.lookup(\"internalClass\"));\n    } ]\n  }, \"\\n\t\t\t\", UI.If(function() {\n    return Spacebars.call(self.lookup(\"title\"));\n  }, UI.block(function() {\n    var self = this;\n    return HTML.H2({\n      \"class\": [ \"tourTitle \", function() {\n        return Spacebars.mustache(self.lookup(\"titleClass\"));\n      } ]\n    }, function() {\n      return Spacebars.mustache(self.lookup(\"title\"));\n    });\n  })), \"\\n\t\t\t\", UI.If(function() {\n    return Spacebars.call(self.lookup(\"content\"));\n  }, UI.block(function() {\n    var self = this;\n    return HTML.P({\n      \"class\": [ \"tourContent \", function() {\n        return Spacebars.mustache(self.lookup(\"contentClass\"));\n      } ]\n    }, function() {\n      return Spacebars.mustache(self.lookup(\"content\"));\n    });\n  })), \"\\n\t\t\t\", HTML.DIV({\n    \"class\": [ \"tourButton \", function() {\n      return Spacebars.mustache(self.lookup(\"buttonClass\"));\n    } ]\n  }, function() {\n    return Spacebars.mustache(self.lookup(\"buttonText\"));\n  }), \"\\n\t\t\"), \"\\n\t\");\n}));\n"]}